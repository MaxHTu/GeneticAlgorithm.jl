using Random
using GeneticAlgorithm

@testset "Crossover" begin
    @testset "single point crossover" begin
        Random.seed!(3)
        child1, child2 = GeneticAlgorithm.single_point_crossover([false,false,false,false],[true,true,true,true])
        @test (child1, child2) == ([false,false,true,true],[true,true,false,false])

        Random.seed!(9)
        child1, child2 = GeneticAlgorithm.single_point_crossover([1.0,4.0,-8.0,16.0],[3.0,-9.0,18.0,6.0])
        @test (child1, child2) == ([1.0,-9.0,18.0,6.0],[3.0,4.0,-8.0,16.0])

        Random.seed!(17)
        a,b = single_point_crossover([-86 26 54; -30 83 56; 40 -62 34], [-67 -40 23; 14 -100 -61; -9 13 -98])
        @test a == [-86 26 23; -30 83 -61; 40 -62 -98]
        @test b == [-67 -40 54; 14 -100 56; -9 13 34]
    end

    @testset "k point crossover" begin
        Random.seed!(3)
        child1, child2 = GeneticAlgorithm.k_point_crossover([false,false,false,false,false,false,false,false],[true,true,true,true,true,true,true,true], 3)
        @test (child1, child2) == ([false,false,true,false,false,false,false,true],[true,true,false,true,true,true,true,false])

        Random.seed!(3)
        child1, child2 = GeneticAlgorithm.k_point_crossover([false,false,false,false,false,false,false,false],[true,true,true,true,true,true,true,true], 5)
        @test (child1, child2) == ([false,true,false,true,false,false,false,true],[true,false,true,false,true,true,true,false])

        Random.seed!(25)
        child1, child2 = GeneticAlgorithm.k_point_crossover([1.0,4.0,-8.0,16.0,2.0,5.0,-4.0,7.0],[3.0,-9.0,18.0,6.0,1.0,9.0,-1.0,-4.0],3)
        @test (child1, child2) == ([1.0, 4.0, 18.0, 6.0, 2.0, 5.0, -4.0, -4.0], [3.0, -9.0, -8.0, 16.0, 1.0, 9.0, -1.0, 7.0])

        Random.seed!(32)
        child1, child2 = GeneticAlgorithm.k_point_crossover([1.0,4.0,-8.0,16.0,2.0,5.0,-4.0,7.0],[3.0,-9.0,18.0,6.0,1.0,9.0,-1.0,-4.0],5)
        @test (child1, child2) == ([1.0, -9.0, -8.0, 6.0, 1.0, 9.0, -4.0, -4.0], [3.0, 4.0, 18.0, 16.0, 2.0, 5.0, -1.0, 7.0])

        Random.seed!(100)
        c1, c2 = GeneticAlgorithm.single_point_crossover([false,false,false,false],[true,true,true,true])
        Random.seed!(100)
        child1, child2 = GeneticAlgorithm.k_point_crossover([false,false,false,false],[true,true,true,true], 1)
        @test (c1, c2) == (child1, child2)

        v = [[-18.058879805407187 -6.724766156995557 30.85412777052744 -43.99719765276693 67.296942354116 -67.03750444391599 60.04761352953659 38.84796581170406 -52.13809103035769 77.77164227384816; -94.4634784042263 75.48942067054153 -96.40963770553701 -51.57114599454344 45.91122699288235 40.84300507253036 19.56579851278515 11.150177485785193 -4.960787951355371 -43.936023249289335; -31.30354006774867 49.616087044841834 3.3143508222312335 -2.162694710867612 -13.240792077737808 38.25493386897324 7.267791284287938 -42.59400922456105 72.93099977416784 -63.54800045196212], [58.81308288910947 37.6620370031666 79.65332006039185 80.53240962344825 67.15869324915138 76.88945275141154 -13.274097381193755 74.14759127107916 -48.20697336223125 -43.160226057386694; 40.11897251885554 -75.29655999226152 -89.24366885176545 -92.80943176938227 -58.90007477186929 49.66643935086523 57.89144141383221 -48.699759323442215 -15.240280288431364 90.52303849473279; 89.41236071800114 -18.679884214486336 73.93574459914717 -48.70682736538732 -74.27616053481248 -33.84785073136973 -44.54203268474306 31.518697362854965 71.65741225936438 -45.380936757438775]]
        Random.seed!(99)
        child1, child2 = GeneticAlgorithm.k_point_crossover(v[1], v[2], 4)
        @test child1 == [-18.058879805407187 -6.724766156995557 30.85412777052744 80.53240962344825 67.296942354116 76.88945275141154 -13.274097381193755 74.14759127107916 -48.20697336223125 77.77164227384816; -94.4634784042263 75.48942067054153 -96.40963770553701 -92.80943176938227 45.91122699288235 49.66643935086523 57.89144141383221 -48.699759323442215 -15.240280288431364 -43.936023249289335; -31.30354006774867 49.616087044841834 3.3143508222312335 -48.70682736538732 -13.240792077737808 -33.84785073136973 -44.54203268474306 31.518697362854965 71.65741225936438 -63.54800045196212]
        @test child2 == [58.81308288910947 37.6620370031666 79.65332006039185 -43.99719765276693 67.15869324915138 -67.03750444391599 60.04761352953659 38.84796581170406 -52.13809103035769 -43.160226057386694; 40.11897251885554 -75.29655999226152 -89.24366885176545 -51.57114599454344 -58.90007477186929 40.84300507253036 19.56579851278515 11.150177485785193 -4.960787951355371 90.52303849473279; 89.41236071800114 -18.679884214486336 73.93574459914717 -2.162694710867612 -74.27616053481248 38.25493386897324 7.267791284287938 -42.59400922456105 72.93099977416784 -45.380936757438775]
    end

    @testset "uniform crossover" begin
        rng = Random.seed!(99)
        child1, child2 = GeneticAlgorithm.uniform_crossover([false,false,false,false],[true,true,true,true])
        @test (child1, child2) == ([false,false,false,true],[true,true,true,false])

        rng = Random.seed!(7)
        child1, child2 = GeneticAlgorithm.uniform_crossover([false,false,false,false,false,false,false,false],[true,true,true,true,true,true,true,true])
        @test (child1, child2) == ([false,true,true,false,true,false,true,true],[true,false,false,true,false,true,false,false])

        v = [[-18.058879805407187 -6.724766156995557 30.85412777052744 -43.99719765276693 67.296942354116 -67.03750444391599 60.04761352953659 38.84796581170406 -52.13809103035769 77.77164227384816; -94.4634784042263 75.48942067054153 -96.40963770553701 -51.57114599454344 45.91122699288235 40.84300507253036 19.56579851278515 11.150177485785193 -4.960787951355371 -43.936023249289335; -31.30354006774867 49.616087044841834 3.3143508222312335 -2.162694710867612 -13.240792077737808 38.25493386897324 7.267791284287938 -42.59400922456105 72.93099977416784 -63.54800045196212], [58.81308288910947 37.6620370031666 79.65332006039185 80.53240962344825 67.15869324915138 76.88945275141154 -13.274097381193755 74.14759127107916 -48.20697336223125 -43.160226057386694; 40.11897251885554 -75.29655999226152 -89.24366885176545 -92.80943176938227 -58.90007477186929 49.66643935086523 57.89144141383221 -48.699759323442215 -15.240280288431364 90.52303849473279; 89.41236071800114 -18.679884214486336 73.93574459914717 -48.70682736538732 -74.27616053481248 -33.84785073136973 -44.54203268474306 31.518697362854965 71.65741225936438 -45.380936757438775]]
        Random.seed!(69)
        child1, child2 = GeneticAlgorithm.uniform_crossover(v[1], v[2])
        @test child1 == [-18.058879805407187 -6.724766156995557 79.65332006039185 -43.99719765276693 67.296942354116 -67.03750444391599 60.04761352953659 74.14759127107916 -52.13809103035769 -43.160226057386694; -94.4634784042263 75.48942067054153 -89.24366885176545 -51.57114599454344 45.91122699288235 40.84300507253036 19.56579851278515 -48.699759323442215 -4.960787951355371 90.52303849473279; -31.30354006774867 49.616087044841834 73.93574459914717 -2.162694710867612 -13.240792077737808 38.25493386897324 7.267791284287938 31.518697362854965 72.93099977416784 -45.380936757438775]
        @test child2 == [58.81308288910947 37.6620370031666 30.85412777052744 80.53240962344825 67.15869324915138 76.88945275141154 -13.274097381193755 38.84796581170406 -48.20697336223125 77.77164227384816; 40.11897251885554 -75.29655999226152 -96.40963770553701 -92.80943176938227 -58.90007477186929 49.66643935086523 57.89144141383221 11.150177485785193 -15.240280288431364 -43.936023249289335; 89.41236071800114 -18.679884214486336 3.3143508222312335 -48.70682736538732 -74.27616053481248 -33.84785073136973 -44.54203268474306 -42.59400922456105 71.65741225936438 -63.54800045196212]
    end
end